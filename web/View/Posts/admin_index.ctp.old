<?php
	$this->Html->script("jquery.nestedAccordion.js", array('inline' => false));
	$this->Html->css("accordion-categories.css", null, array('inline' => false));
	$this->Html->script("functions.js", array('inline' => false));
	$this->append('script');?>
	<script type="text/javascript">		
		jQuery(document).ready(function($){
			$(".PostVersionLanguage").click(function(){
				id=$(this).attr("id").replace("PostVersion-", "");;
				$.ajax({
					async:true, 
					data:{
						id:id,
						active:$(this).is(':checked'),
					},
					dataType:"html", 
					success:function (data) {
					}, 
					type:"post",
					url:"/admin/postVersions/ajaxActivate"
				});
			});

			createIcons();
			
		});

		
	</script>
	<script type="text/javascript">
	<!--//--><![CDATA[//><!--

		$("html").addClass("js");
		$.fn.accordion.defaults.container = false;
		$(function() {
			
		$("#acc1").accordion({
			el: ".h",
			head: "h4, h5",
			next: "div",
			showMethod: "slideFadeDown",
			hideMethod: "slideFadeUp", 
		});
			
			$("html").removeClass("js");
		});
	//--><!]]>
	</script> <?php
	$this->end(); ?>
<ul class="accordion" id="acc1"><?php

	foreach ($nestedCategories as $nC)
		$this->View->stepIn($nC, $postVersions, $languages);
	
	?>
</ul>
<?php  /*?>
<div class="posts">
	<h2><?php echo __('Posts');?></h2>
	<table cellpadding="0" cellspacing="0">
	<tr>
		<th><?php echo $this->Paginator->sort('code');?></th>
		<th><?php echo $this->Paginator->sort('order');?></th><?php 
		foreach ($languages as $language) {?>
			<th><?php echo $this->Html->image($language['Language']['flag']); ?>&nbsp;</th><?php
		}?>
		<th class="actions"><?php echo __('Actions');?></th>
	</tr>
	<?php
	foreach ($posts as $post): ?>
	<tr>
		<td><?php echo h($post['Post']['code']); ?>&nbsp;</td>
		<td><?php echo h($post['Post']['order']); ?>&nbsp;</td><?php 
		foreach ($languages as $language) {?>
			<td><input class="PostVersionLanguage" id="PostVersion-<?php echo $postVersions[$post['Post']['id']][$language['Language']['id']]['PostVersion']['id']?>" type="checkbox" <?php if ($postVersions[$post['Post']['id']][$language['Language']['id']]['PostVersion']['active']) echo "checked='checked'"; ?> /></td><?php
		}?>
		<td class="actions">
			<?php echo $this->Html->link(__('Edit'), array('action' => 'edit', $post['Post']['id'])); ?>
			<?php echo $this->Form->postLink(__('Delete'), array('action' => 'delete', $post['Post']['id']), null, __('Are you sure you want to delete # %s?', $post['Post']['id'])); ?>
		</td>
	</tr>
<?php endforeach; ?>

<?php /*?><div class="actions">
	<h3><?php echo __('Actions'); ?></h3>
	<ul>
		<li><?php echo $this->Html->link(__('New Post'), array('action' => 'add')); ?></li>
		<li><?php echo $this->Html->link(__('List Post Versions'), array('controller' => 'post_versions', 'action' => 'index')); ?> </li>
		<li><?php echo $this->Html->link(__('New Post Version'), array('controller' => 'post_versions', 'action' => 'add')); ?> </li>
	</ul>
</div>*/?>
